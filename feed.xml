<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://runqiuye.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://runqiuye.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-05-26T18:08:57+00:00</updated><id>https://runqiuye.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Counting numbers</title><link href="https://runqiuye.github.io/blog/2025/numdp/" rel="alternate" type="text/html" title="Counting numbers"/><published>2025-01-29T00:00:00+00:00</published><updated>2025-01-29T00:00:00+00:00</updated><id>https://runqiuye.github.io/blog/2025/numdp</id><content type="html" xml:base="https://runqiuye.github.io/blog/2025/numdp/"><![CDATA[<p>This is a document I wrote a while ago, before I create this website. It is quite interesting, so I am making this my first blog post on this website to help me set up the blog section and keep the document.</p> <hr/> <p>I was doing some practices on the CSES problem set, and this number counting dynamic programming problem interests me a lot. This is an example of a type of problems where we need to count numbers that satisfies a given requirement, but the range of the numbers is too large for us to check one by one, such as \(10^{18}\). Therefore, we need to use dynamic programming to speed up the counting. This is also the first time I solve a problem like this, so I decide to document my thought process and solution.</p> <h2 id="problem">Problem</h2> <p>Count the number of integers between \(a\) and \(b\) where <strong>no two adjacent digits are the same</strong>.</p> <h4 id="input">Input</h4> <p>The only input line has two integers \(a\) and \(b\).</p> <h4 id="output">Output</h4> <p>Print one integer – the answer to the problem.</p> <h4 id="constraints">Constraints</h4> <p>The integers \(a\) and \(b\) are such that \(0 \leq a \leq b \leq 10^{18}\)</p> <h4 id="example">Example</h4> <p>Input</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>123 321
</code></pre></div></div> <p>Output</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>171
</code></pre></div></div> <h2 id="solution">Solution</h2> <p>If we can calculate the number of integers between \(0\) and \(n\) with no two adjacent digits for any nonnegative \(n\), then the answer is just the count for \([0, b]\) and minus the count for \([0, a - 1]\). We will write a function called <code class="language-plaintext highlighter-rouge">solve</code> that solves this reduced problem.</p> <p>Note that for a number to have no two adjacent digits being the same, the first and second digit on the left cannot be the same, and the “subnumber” starting from the second digits on the left and all the way to the right cannot have two ajacent digits being the same either. We have then found a natural subproblem for dynamic programming.</p> <p>First count the number of integers with \(i\) digits that start with some digit (for example starting with \(1\), or \(2\), it doesn’t matter), have no adjacent digits being the same, call this \(f_i\). Note that we do not consider any leading zeros here. This might be a bit confusing to parse. Consider this example — \(f_3\) is the number of 3-digits numbers that start with a \(1\) and have no adjacent digits being the same. Then we note that \(f_i = 9 f_{i-1}\), since we already set the first digit and the second digit has \(9\) options for it to be different than the first. Also \(f_1 = 1\), because for example there is only one 1-digit number that start with the digit \(2\), namely the number \(2\). We can preprocess \(f_i\) for \(1 \leq i \leq 18\).</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">;</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1LL</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9LL</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">solve</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">solve</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>For our main function <code class="language-plaintext highlighter-rouge">solve</code>, we first need to convert the number into an array of digits.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">len</span><span class="o">++</span><span class="p">;</span>
        <span class="n">a</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span><span class="p">;</span>
        <span class="n">n</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// ......</span>
<span class="p">}</span>
</code></pre></div></div> <p>To illustrate this with an example, consider <code class="language-plaintext highlighter-rouge">solve(2413)</code>. Then the <code class="language-plaintext highlighter-rouge">a</code> array and the variable <code class="language-plaintext highlighter-rouge">len</code> would be</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a = [0, 3, 1, 4, 2]
len = 4
</code></pre></div></div> <p>Now we start the counting process, for a number with 4 digits and the leading digit being <code class="language-plaintext highlighter-rouge">0</code> and <code class="language-plaintext highlighter-rouge">1</code>, there is <code class="language-plaintext highlighter-rouge">f[4]</code> integers without two adjacent digits being the same. For leading digit <code class="language-plaintext highlighter-rouge">2</code> we have to consider the boundary so we handle that using next iteration. The next iteration is essentially counting the number of integers with 4 digits, starting with <code class="language-plaintext highlighter-rouge">2</code>, and no two adjacent digits are the same. For <code class="language-plaintext highlighter-rouge">0</code>, <code class="language-plaintext highlighter-rouge">1</code>, <code class="language-plaintext highlighter-rouge">2</code> and <code class="language-plaintext highlighter-rouge">3</code> on <code class="language-plaintext highlighter-rouge">a[3]</code> we can use our <code class="language-plaintext highlighter-rouge">f[3]</code> value directly and we handle the boundary <code class="language-plaintext highlighter-rouge">4</code> with next iteration. Therefore, our main loop is</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="n">res</span> <span class="o">-=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">flag</span><span class="p">)</span> <span class="n">res</span><span class="o">++</span><span class="p">;</span>
</code></pre></div></div> <p>Notice that when <code class="language-plaintext highlighter-rouge">a[i] &gt; a[i + 1]</code>, we should not count the numbers with <code class="language-plaintext highlighter-rouge">a[i] = a[i + 1]</code> so we use <code class="language-plaintext highlighter-rouge">res -= f[i]</code> to handle that. In addition, when <code class="language-plaintext highlighter-rouge">a[i] = a[i + 1]</code> since we are essentially counting the numbers starting with <code class="language-plaintext highlighter-rouge">a[i+1 : len]</code> in later iterations and <code class="language-plaintext highlighter-rouge">a[i] = a[i + 1]</code> indicates the presence of two adjacent digits being the same, we break from the loop. Finally the <code class="language-plaintext highlighter-rouge">flag</code> and <code class="language-plaintext highlighter-rouge">res++</code> is used to handle the number itself.</p> <p>To deal with leading zeros, we remove the contribution from leading digits being zeros first by <code class="language-plaintext highlighter-rouge">res -= f[len]</code>, and then add the contribution from integers with <code class="language-plaintext highlighter-rouge">j</code> digits starting with <code class="language-plaintext highlighter-rouge">1</code> to <code class="language-plaintext highlighter-rouge">9</code> (ensuring no leading zeros) for <code class="language-plaintext highlighter-rouge">1 &lt;= j &lt;= len</code>.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">res</span> <span class="o">-=</span> <span class="n">f</span><span class="p">[</span><span class="n">len</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="mi">9LL</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="p">}</span>
<span class="n">res</span><span class="o">++</span><span class="p">;</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">res++</code> is used to handle the number <code class="language-plaintext highlighter-rouge">0</code>. This finishes this function and the complete solution code is as follows.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>

<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">len</span><span class="o">++</span><span class="p">;</span>
        <span class="n">a</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">10</span><span class="p">;</span>
        <span class="n">n</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="n">res</span> <span class="o">-=</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="o">&amp;&amp;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">flag</span><span class="p">)</span> <span class="n">res</span><span class="o">++</span><span class="p">;</span>

    <span class="n">res</span> <span class="o">-=</span> <span class="n">f</span><span class="p">[</span><span class="n">len</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="mi">9LL</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">res</span><span class="o">++</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">l</span> <span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">;</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1LL</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9LL</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">solve</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">solve</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>]]></content><author><name></name></author><category term="study"/><category term="computer science"/><category term="algorithms"/><summary type="html"><![CDATA[An number counting dynamic programming problem.]]></summary></entry></feed>